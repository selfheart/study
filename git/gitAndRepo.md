<div align='center'>git And repo</div>

## 1.git 

### 1.1 git checkout 

1.1.1 git 将某个目录下的所有文件回退到上个版本

如果您想要将Git仓库中某个目录下的所有文件回退到上一个版本，可以按照以下步骤进行操作：

1. 确保您在Git仓库所在的目录中打开终端或命令提示符。

2. 首先，使用`git log`命令查看提交历史，并找到您想要回退的上一个版本对应的提交哈希值（commit hash）。

3. 使用`cd`命令进入要回退的目录。例如，如果要回退的目录是`src/`，则可以执行`cd src/`。

4. 运行以下命令来撤销该目录下的所有更改并回退到上一个版本：

   ```shell
   git checkout HEAD~ -- .
   ```

   这将使该目录下的所有文件回滚到上一个版本。

5. 运行`git status`命令来确认回退是否成功，工作目录中的文件应显示为已修改但未暂存的状态。

6. 最后，使用`git add .`将回退的更改添加到暂存区，然后使用`git commit`提交这些更改。

请注意，此方法会更改Git仓库中的历史记录。如果您已经共享了这些提交或其他人正在基于这些提交进行工作，使用此方法可能会导致问题。在执行操作之前，请确保与团队合作并遵循相应的Git工作流程。



### 1.2 git 不提交本地代码，拉代码

如果你在本地有未提交的代码修改，但想要拉取最新的代码而不提交你的本地修改，可以使用以下命令：

1. 先使用 `git stash` 命令将本地修改保存到一个临时栈中：
```bash
git stash
```
这会将你的本地修改保存为一个新的存储项，使你的工作目录变回干净状态。

2. 然后执行 `git pull` 命令来拉取最新的代码：
```bash
git pull
```
这会从远程仓库拉取最新的代码更新到你的本地分支。

3. 如果你之前使用了 `git stash` 命令暂存了本地修改，现在可以使用 `git stash pop` 命令将之前的修改应用回来：
```bash
git stash pop
```
这会将之前的修改从临时栈中取出并应用到你的工作目录中。

请注意，这种操作可能会导致冲突，因为你将尝试将未提交的修改与从远程仓库拉取的最新代码合并。在处理冲突时，请按照 Git 提示进行解决。

记得在执行任何操作前，先备份重要的代码，以免意外数据丢失。

### 1.3 git branch

在 Git 中，分支 (branch) 是用于在版本控制中管理代码不同版本的重要概念。下面是一些常见的 Git 分支相关操作介绍：

1. 创建分支：使用 `git branch` 命令可以创建一个新的分支。例如，要创建名为 `feature` 的新分支，可以运行以下命令：
   ```
   git branch feature
   ```

2. 切换分支：使用 `git checkout` 命令可以切换到已存在的分支。例如，要切换到 `feature` 分支，可以运行以下命令：
   ```
   git checkout feature
   ```

   <font color='red'>注意：当前分支内容没有commit的话，切换分支会删除当前分支未保存内容</font>
   
   或者，您可以使用 `git switch` 命令进行切换（Git 2.23+ 版本）。例如：
   
```
   git switch feature
```

3. 创建并切换分支：使用 `git checkout -b` 命令可以同时创建并切换到一个新分支。例如，要创建并切换到名为 `feature` 的新分支，可以运行以下命令：
   ```
   git checkout -b feature
   ```

   或者，使用 `git switch -c` 命令来实现相同的效果（Git 2.23+ 版本）。例如：
   ```
   git switch -c feature
   ```

4. 查看分支：使用 `git branch` 命令可以查看仓库中所有的本地分支。运行 `git branch -r` 可以查看远程分支。添加 `-a` 参数可以同时查看本地和远程分支。

5. 删除分支：使用 `git branch -d` 命令可以删除已合并的本地分支。例如，要删除名为 `feature` 的分支，可以运行以下命令：
   ```
   git branch -d feature
   ```

   如果要强制删除一个尚未合并的分支，可以使用 `git branch -D` 命令：
   ```
   git branch -D feature
   ```

6. 追踪远程分支：使用 `git branch --set-upstream-to` 或 `git branch --track` 命令可以将本地分支与远程分支关联起来，并跟踪远程分支的更改。例如，要将本地分支 `feature` 关联到远程分支 `origin/feature`，可以运行以下命令：
   ```
   git branch --set-upstream-to=origin/feature feature
   ```

7. 合并分支：使用 `git merge` 命令可以将一个分支合并到当前所在的分支中。例如，如果希望将 `feature` 分支合并到当前分支，可以先切换到目标分支（例如 `main` 或 `master`），然后运行以下命令：
   ```
   git merge feature
   ```

8. 重命名分支：使用 `git branch -m` 命令可以对分支进行重命名。例如，要将当前分支重命名为 `new-feature`，可以运行以下命令：
   ```
   git branch -m new-feature
   ```

上述只是 Git 中的一些常见分支相关操作介绍，Git 还有更多用于管理和操作分支的命令和技巧。使用这些分支操作可以帮助您在开发过程中更好地组织和管理不同版本的代码。

### 1.4 回退到某次提交

	要将 Git 仓库回退到某次提交，你可以使用以下命令：

1. 首先，使用 `git log` 命令查看提交历史，找到你想要回退的提交的哈希值（commit hash）或者提交消息。

2. 然后，使用 `git reset` 命令进行回退。有几种不同的 `--hard`、`--soft` 和 `--mixed` 模式可以选择：

   - 使用 `--hard` 参数会彻底回退到指定的提交，丢弃之后的所有修改（慎用，会永久删除修改）。

     ```bash
     git reset --hard <commit_hash>
     ```

   - 使用 `--soft` 参数会回退到指定的提交，但保留未提交的修改作为暂存区的更改。

     ```bash
     git reset --soft <commit_hash>
     ```

   - 使用 `--mixed` 参数（默认模式）会回退到指定的提交，并取消已经暂存的修改。

     ```bash
     git reset --mixed <commit_hash>
     ```

   请将 `<commit_hash>` 替换为你要回退到的提交的哈希值或者提交消息。

3. 最后，你可能需要使用 `git push` 将这个回退操作推送到远程仓库（如果有必要）。

请注意，回退操作会改变 Git 仓库的历史记录，如果有其他开发者共享这个仓库，回退操作可能会对他们的工作造成影响。在执行回退操作之前，请确保你理解回退的影响，并与团队成员进行沟通。此外，强烈建议在执行修改历史记录的操作之前，创建一个备份分支以防止数据丢失。

### 1.5 git 切换到远程分支

在Git中要切换到远程分支，需要先将该远程分支拉取到本地，然后再切换到已经拉取的本地分支。以下是一些相关的命令：

1. 拉取远程分支：

   ```
   git fetch <remote-name>
   ```

   其中，`<remote-name>` 是远程仓库的名称。这条命令将会更新本地仓库中的远程分支列表。

2. 查看远程分支列表：

   ```
   git branch -r
   ```

   这将列出所有远程分支的列表，包括刚刚更新的远程分支。

3. 拉取远程分支到本地（创建本地分支）：

   ```
   git checkout -b <local-branch-name> <remote-name>/<remote-branch-name>
   ```

   其中，`<local-branch-name>` 是你想要创建的本地分支的名称，`<remote-name>/<remote-branch-name>` 是远程分支的名称。

4. 切换到已拉取的本地分支：

   ```
   git checkout <local-branch-name>
   ```

   这将把当前工作区切换到指定的本地分支。

请注意，在切换到远程分支之前，你需要确保已经将远程分支拉取到本地。如果你没有拉取远程分支，可以使用 `git fetch` 命令先将远程分支更新到本地，然后再进行切换操作。

## 2.repo

Google 的 Repo 是一个用于管理多个 Git 仓库的工具，它可以帮助开发团队在一个项目中同时管理多个代码仓库。Repo 工具使用 XML 格式的清单文件来描述仓库之间的关系和配置。

以下是 Google Repo 工具的一些重要概念和功能：

1. 初始化 Repo：使用 Repo 工具的第一步是在本地创建一个 Repo 客户端工作区。您需要运行 `repo init` 命令，并提供一个包含仓库配置信息的清单文件。这个清单文件通常存放在远程服务器上，可以是一个版本控制仓库。

2. 同步代码：一旦初始化 Repo，您可以使用 `repo sync` 命令来同步所有代码仓库到本地工作区。这会将清单文件中列出的仓库克隆到本地，并保持与远程仓库的同步。

3. 创建分支和提交更改：在 Repo 工作区中，您可以切换到特定的仓库目录，并像普通的 Git 仓库一样创建分支、提交更改等。这些更改通常会在每个独立的仓库中完成。

4. 多个仓库的管理：Repo 工具使得同时管理多个 Git 仓库变得更加容易。您可以通过运行 `repo forall` 命令来在所有仓库中执行批量操作，也可以使用 `repo status` 命令来查看所有仓库的状态。

5. 分支管理和跟踪：Repo 工具支持多个仓库的分支管理和跟踪。您可以在清单文件中指定默认的分支，也可以使用 `repo start`、`repo branch` 等命令来创建和管理分支。

6. 版本控制和代码审阅：Repo 工具集成了版本控制系统和代码审阅工具（如 Git 和 Gerrit），使得多个仓库之间的代码合并、提交审阅等过程更加流畅。

7. 插件支持：Repo 工具支持插件机制，使得开发者可以编写自定义插件来扩展 Repo 的功能。

通过 Repo 工具，开发团队可以更好地组织和管理复杂的项目结构，加快代码同步和合并的速度，提高协作效率。它在 Google 内部被广泛应用于众多开源项目和内部项目的开发过程中。详细的使用文档和示例可以在 Google 的官方 Repo 仓库中找到。



### 2.1 放弃本地所有的修改

要放弃本地所有的修改，您可以使用以下命令：

```
repo forall -c 'git reset --hard'
```

这个命令会遍历当前 Repo 工作区中的所有仓库，并在每个仓库中执行 `git reset --hard` 命令，将所有未提交的更改全部丢弃。请注意，这将清除所有未提交的更改，包括新增、修改或删除的文件。

在运行上述命令之前，请确保您处于 Repo 工作区的根目录下。

请额外注意，这个操作是不可逆的，请谨慎使用，并确保您真正希望放弃当前所有的修改，并且没有重要的未提交的代码更改。

### 2.2回退到指定的日期之前

repo forall -c 'git reset --hard `git rev-list --before="<date>" -n 1 HEAD`'

上述命令会将每个存储库都回退到指定日期之前的状态，并丢弃该日期之后的所有修改。

请将 `<date>` 替换为你要回退到的日期，例如 `2021-08-01`。



